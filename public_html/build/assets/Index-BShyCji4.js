import{r as n,b as q,u as X,a as g,j as e,H as $,L as M}from"./app-BsRi02Wf.js";import{A as Q,C as U}from"./app-layout-CdBpmueg.js";import{B as t}from"./button-4wnz9Zqb.js";import{I as W}from"./input-BYt-uUAG.js";import{T as Y,a as Z,b,c as o,d as ee,e as d}from"./table-DRM6CSbC.js";import{X as ae,D as se,a as le,b as re,c as ie,d as te,e as ne}from"./activity-feed-button-BJ1WYF4g.js";import{S as m,a as h,b as x,c as u,d as s}from"./select-BiJMe3QD.js";import{A as S,b as N,a as _}from"./alert-Ckucn3LG.js";import{B as de}from"./badge-C_t0DFeo.js";import{L as ce}from"./label-CW3bZicJ.js";import{P as oe,A as me,a as he,b as xe,c as ue,d as je,e as pe,f as ge,g as fe}from"./alert-dialog-DjuTxtoT.js";import{C as ke}from"./circle-check-DQIK-M0p.js";import{c as ve}from"./utils-Cuk0kyiu.js";import{P as we}from"./plus-N0VNghkl.js";import{S as be}from"./search-CLez4lf4.js";import{F as Se}from"./filter-DKx0l9wP.js";import{T as Ne}from"./trash-2-DHkJLRzk.js";/* empty css            */import"./index-C0N98Kzt.js";import"./user-menu-content-CaD6Lgdg.js";import"./index-CZi-UQ4q.js";import"./index-D-s97nNy.js";import"./building-2-QMJfTkD6.js";import"./calendar-DXPEKcan.js";import"./users-ezrJfIw7.js";import"./clock-CX7qgJh_.js";import"./index-VkL8W5Kt.js";import"./check-UcFQ4tla.js";const _e=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ce=ve("TriangleAlert",_e);function aa({jadwalMaster:C,semester:D,dosen:H,laboratorium:K,filters:f,breadcrumbs:L}){const[k,v]=n.useState(null),[B,j]=n.useState(!1),{data:P,setData:z,post:G,processing:T}=q({semester_id:""}),{flash:l}=X().props,[A,y]=n.useState(!1),[w,F]=n.useState(!1),[r,J]=n.useState(f||{}),c=(a,p)=>{J(R=>({...R,[a]:p}))},i=()=>{g.get("/jadwal-master",r,{preserveState:!0})},I=()=>{J({}),g.get("/jadwal-master",{},{preserveState:!0})},V=a=>{a.preventDefault(),i()};n.useEffect(()=>{if(l.success||l.warning){y(!0);const a=setTimeout(()=>{y(!1),l.konflik&&g.reload({only:["konflik"]})},5e3);return()=>clearTimeout(a)}},[l]),n.useEffect(()=>{const a=Object.values(f||{}).some(p=>p!==void 0&&p!=="");F(a)},[f]);const O=()=>{k&&g.delete(`/jadwal-master/${k}`,{onSuccess:()=>v(null)})},E=a=>{a.preventDefault(),G("/jadwal/generate",{onSuccess:()=>j(!1)})};return e.jsxs(Q,{breadcrumbs:L,children:[e.jsx($,{title:"Jadwal Master"}),A&&l.success&&e.jsxs(S,{className:"fixed top-4 right-4 z-50 w-auto max-w-md animate-in slide-in-from-top",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx(N,{children:"Berhasil!"}),e.jsx(_,{children:l.success})]}),A&&l.warning&&e.jsxs(S,{variant:"destructive",className:"fixed top-4 right-4 z-50 w-auto max-w-md animate-in slide-in-from-top",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx(N,{children:"Peringatan Generate Jadwal"}),e.jsx(_,{children:l.warning})]}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[l.konflik&&e.jsxs(S,{variant:"destructive",children:[e.jsx(XCircle,{className:"h-4 w-4"}),e.jsxs(N,{children:["Ditemukan ",l.konflik.length," Konflik Jadwal"]}),e.jsx(_,{children:e.jsx("ul",{className:"list-disc pl-5",children:l.konflik.map(a=>e.jsxs("li",{children:[e.jsxs("strong",{children:[a.deskripsi,":"]})," ",a.penyebab]},a.master_id))})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Jadwal Master"}),e.jsx("p",{className:"text-muted-foreground",children:"Kelola data mentah jadwal sebelum digenerate."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:"outline",onClick:()=>j(!0),children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Generate Jadwal"]}),e.jsx(M,{href:"/jadwal-master/create",children:e.jsxs(t,{children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Tambah Jadwal"]})})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("form",{onSubmit:V,className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(W,{placeholder:"Cari kelas, mata kuliah, dosen, atau laboratorium...",value:r.search||"",onChange:a=>{c("search",a.target.value),a.target.value===""&&i()},onKeyDown:a=>a.key==="Enter"&&i(),className:"pl-9 h-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:w?"default":"outline",onClick:()=>F(!w),className:"gap-2 h-10 whitespace-nowrap",size:"sm",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Filter"}),Object.values(r).filter(a=>a).length>0&&e.jsx(de,{variant:"secondary",className:"ml-1 px-1.5 min-w-5 h-5",children:Object.values(r).filter(a=>a).length})]}),Object.values(r).some(a=>a)&&e.jsxs(t,{variant:"ghost",size:"sm",onClick:I,className:"h-10 gap-1",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Reset"})]})]})]}),w&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 p-3 border rounded-lg bg-gradient-to-br from-muted/50 to-muted/30 backdrop-blur-sm",children:[e.jsxs(m,{value:r.semester_id||"all",onValueChange:a=>{c("semester_id",a==="all"?"":a),setTimeout(i,100)},children:[e.jsx(h,{className:"h-9 text-sm",children:e.jsx(x,{placeholder:"Semester"})}),e.jsxs(u,{children:[e.jsx(s,{value:"all",children:"Semua Semester"}),D.map(a=>e.jsx(s,{value:String(a.id),children:a.nama},a.id))]})]}),e.jsxs(m,{value:r.dosen_id||"all",onValueChange:a=>{c("dosen_id",a==="all"?"":a),setTimeout(i,100)},children:[e.jsx(h,{className:"h-9 text-sm",children:e.jsx(x,{placeholder:"Dosen"})}),e.jsxs(u,{children:[e.jsx(s,{value:"all",children:"Semua Dosen"}),H.map(a=>e.jsx(s,{value:String(a.id),children:a.user.name},a.id))]})]}),e.jsxs(m,{value:r.laboratorium_id||"all",onValueChange:a=>{c("laboratorium_id",a==="all"?"":a),setTimeout(i,100)},children:[e.jsx(h,{className:"h-9 text-sm",children:e.jsx(x,{placeholder:"Laboratorium"})}),e.jsxs(u,{children:[e.jsx(s,{value:"all",children:"Semua Lab"}),K.map(a=>e.jsx(s,{value:String(a.id),children:a.nama},a.id))]})]}),e.jsxs(m,{value:r.hari||"all",onValueChange:a=>{c("hari",a==="all"?"":a),setTimeout(i,100)},children:[e.jsx(h,{className:"h-9 text-sm",children:e.jsx(x,{placeholder:"Hari"})}),e.jsxs(u,{children:[e.jsx(s,{value:"all",children:"Semua Hari"}),e.jsx(s,{value:"Senin",children:"Senin"}),e.jsx(s,{value:"Selasa",children:"Selasa"}),e.jsx(s,{value:"Rabu",children:"Rabu"}),e.jsx(s,{value:"Kamis",children:"Kamis"}),e.jsx(s,{value:"Jumat",children:"Jumat"}),e.jsx(s,{value:"Sabtu",children:"Sabtu"}),e.jsx(s,{value:"Minggu",children:"Minggu"})]})]}),e.jsxs(m,{value:r.status_konflik||"all",onValueChange:a=>{c("status_konflik",a==="all"?"":a),setTimeout(i,100)},children:[e.jsx(h,{className:"h-9 text-sm",children:e.jsx(x,{placeholder:"Konflik"})}),e.jsxs(u,{children:[e.jsx(s,{value:"all",children:"Semua"}),e.jsx(s,{value:"true",children:"Ada Konflik"}),e.jsx(s,{value:"false",children:"Tidak Ada"})]})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsxs(b,{children:[e.jsx(o,{children:"Kelas & Matkul"}),e.jsx(o,{children:"Dosen"}),e.jsx(o,{children:"Jadwal"}),e.jsx(o,{children:"Laboratorium"}),e.jsx(o,{children:"Semester"}),e.jsx(o,{className:"text-right",children:"Aksi"})]})}),e.jsx(ee,{children:C.length===0?e.jsx(b,{children:e.jsx(d,{colSpan:6,className:"text-center text-muted-foreground",children:"Belum ada data jadwal"})}):C.map(a=>e.jsxs(b,{children:[e.jsxs(d,{className:"font-medium",children:[a.kelas_matkul.kelas.nama," - Semester ",a.kelas_matkul.kelas.tingkat_semester," - ",a.kelas_matkul.mata_kuliah.nama]}),e.jsx(d,{children:a.dosen.user.name}),e.jsxs(d,{children:[a.hari,", ",a.slot_waktu_mulai.waktu_mulai.slice(0,5)," -"," ",a.slot_waktu_selesai.waktu_selesai.slice(0,5),e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",a.kelas_matkul.mata_kuliah.sks," SKS)"]})]}),e.jsx(d,{children:a.laboratorium.nama}),e.jsx(d,{children:a.semester.nama}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{href:`/jadwal-master/${a.id}/edit`,children:e.jsx(t,{variant:"outline",size:"sm",children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>v(a.id),children:e.jsx(Ne,{className:"h-4 w-4 text-destructive"})})]})})]},a.id))})]})}),e.jsx(me,{open:k!==null,onOpenChange:()=>v(null),children:e.jsxs(he,{children:[e.jsxs(xe,{children:[e.jsx(ue,{children:"Konfirmasi Hapus"}),e.jsx(je,{children:"Apakah Anda yakin ingin menghapus data jadwal ini?"})]}),e.jsxs(pe,{children:[e.jsx(ge,{children:"Batal"}),e.jsx(fe,{onClick:O,children:"Hapus"})]})]})}),e.jsx(se,{open:B,onOpenChange:j,children:e.jsxs(le,{children:[e.jsxs(re,{children:[e.jsx(ie,{children:"Generate Jadwal"}),e.jsx(te,{children:"Pilih semester untuk membuat jadwal final. Proses ini akan menghapus jadwal lama (jika ada) untuk semester yang dipilih dan menggantinya dengan yang baru berdasarkan data dari Jadwal Master."})]}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ce,{htmlFor:"semester_id",children:"Semester"}),e.jsxs(m,{onValueChange:a=>z("semester_id",a),required:!0,children:[e.jsx(h,{id:"semester_id",children:e.jsx(x,{placeholder:"Pilih Semester"})}),e.jsx(u,{children:D.map(a=>e.jsx(s,{value:String(a.id),children:a.nama},a.id))})]})]}),e.jsxs(ne,{children:[e.jsx(t,{type:"button",variant:"ghost",onClick:()=>j(!1),children:"Batal"}),e.jsx(t,{type:"submit",disabled:T||!P.semester_id,children:T?"Memproses...":"Mulai Generate"})]})]})]})})]})]})]})}export{aa as default};
