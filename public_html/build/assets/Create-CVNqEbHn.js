import{b as V,r as c,j as a,H,L as A,c as R}from"./app-BsRi02Wf.js";import{A as z}from"./app-layout-CdBpmueg.js";import{B as x}from"./button-4wnz9Zqb.js";import{C as D,a as L,b as B,d as T,c as F}from"./card-CtvO2SYM.js";import{S as h,a as g,b as p,c as _,d as j}from"./select-BiJMe3QD.js";import{T as J}from"./textarea-CQXLHOGr.js";import{I as M}from"./input-BYt-uUAG.js";import{L as r}from"./label-CW3bZicJ.js";import{A as k,a as b}from"./alert-Ckucn3LG.js";import{A as q}from"./arrow-left-99kuOXcC.js";import{C as G}from"./clock-CX7qgJh_.js";import{C as Q}from"./circle-check-DQIK-M0p.js";import{C as U}from"./circle-alert-DganHivA.js";import{B as X}from"./building-2-QMJfTkD6.js";/* empty css            */import"./utils-Cuk0kyiu.js";import"./activity-feed-button-BJ1WYF4g.js";import"./index-CZi-UQ4q.js";import"./badge-C_t0DFeo.js";import"./index-C0N98Kzt.js";import"./user-menu-content-CaD6Lgdg.js";import"./index-D-s97nNy.js";import"./calendar-DXPEKcan.js";import"./users-ezrJfIw7.js";import"./index-VkL8W5Kt.js";import"./check-UcFQ4tla.js";const Y=[{title:"Dashboard",href:"/dashboard"},{title:"Booking Lab",href:"/booking-lab"},{title:"Booking Baru",href:"/booking-lab/create"}];function Na({laboratoriums:f,slotWaktu:l}){const{data:s,setData:i,post:I,processing:u,errors:t}=V({laboratorium_id:"",tanggal:"",slot_waktu_mulai_id:"",slot_waktu_selesai_id:"",durasi_slot:1,keperluan:"",keterangan:""}),[m,v]=c.useState(!1),[n,d]=c.useState(null),P=()=>{if(!s.slot_waktu_mulai_id||!s.slot_waktu_selesai_id)return;const e=l.find(o=>o.id.toString()===s.slot_waktu_mulai_id),C=l.find(o=>o.id.toString()===s.slot_waktu_selesai_id);if(e&&C){const o=l.indexOf(e),O=l.indexOf(C)-o+1;i("durasi_slot",O)}};c.useEffect(()=>{P()},[s.slot_waktu_mulai_id,s.slot_waktu_selesai_id]);const E=async()=>{if(!s.laboratorium_id||!s.tanggal||!s.slot_waktu_mulai_id||s.durasi_slot<1){d({available:!1,message:"Mohon lengkapi data laboratorium, tanggal, dan waktu terlebih dahulu"});return}v(!0),d(null);try{const e=await R.post("/booking-lab/check-availability",{laboratorium_id:s.laboratorium_id,tanggal:s.tanggal,slot_waktu_mulai_id:s.slot_waktu_mulai_id,durasi_slot:s.durasi_slot});d({available:e.data.available,message:e.data.message}),e.data.available&&e.data.slot_waktu_selesai_id&&i("slot_waktu_selesai_id",e.data.slot_waktu_selesai_id.toString())}catch(e){d({available:!1,message:e.response?.data?.message||"Terjadi kesalahan saat mengecek ketersediaan"})}finally{v(!1)}};c.useEffect(()=>{s.laboratorium_id&&s.tanggal&&s.slot_waktu_mulai_id&&s.durasi_slot>0&&E()},[s.laboratorium_id,s.tanggal,s.slot_waktu_mulai_id,s.durasi_slot]);const K=e=>{e.preventDefault(),I("/booking-lab")},w=e=>e?new Date(e).toLocaleDateString("id-ID",{weekday:"long",day:"2-digit",month:"long",year:"numeric"}):"",N=f.find(e=>e.id.toString()===s.laboratorium_id),y=l.find(e=>e.id.toString()===s.slot_waktu_mulai_id),S=l.find(e=>e.id.toString()===s.slot_waktu_selesai_id);return a.jsxs(z,{breadcrumbs:Y,children:[a.jsx(H,{title:"Booking Lab Baru"}),a.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(A,{href:"/booking-lab",children:a.jsx(x,{variant:"outline",size:"icon",children:a.jsx(q,{className:"h-4 w-4"})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Booking Laboratorium"}),a.jsx("p",{className:"text-muted-foreground",children:"Ajukan booking laboratorium untuk kegiatan di luar jadwal kuliah"})]})]}),a.jsxs("form",{onSubmit:K,className:"space-y-6",children:[a.jsxs(D,{children:[a.jsxs(L,{children:[a.jsx(B,{children:"1. Pilih Laboratorium dan Waktu"}),a.jsx(T,{children:"Pilih laboratorium yang ingin dibooking beserta tanggal dan waktunya"})]}),a.jsxs(F,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(r,{htmlFor:"laboratorium_id",children:["Laboratorium ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsxs(h,{value:s.laboratorium_id,onValueChange:e=>i("laboratorium_id",e),children:[a.jsx(g,{children:a.jsx(p,{placeholder:"Pilih laboratorium"})}),a.jsx(_,{children:f.map(e=>a.jsx(j,{value:e.id.toString(),children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"font-medium",children:[e.nama," (",e.kode,")"]}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.kampus," • Kapasitas: ",e.kapasitas," ","orang"]})]})},e.id))})]}),t.laboratorium_id&&a.jsx("p",{className:"text-sm text-destructive",children:t.laboratorium_id})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(r,{htmlFor:"tanggal",children:["Tanggal ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsx(M,{id:"tanggal",type:"date",value:s.tanggal,min:new Date().toISOString().split("T")[0],onChange:e=>i("tanggal",e.target.value)}),t.tanggal&&a.jsx("p",{className:"text-sm text-destructive",children:t.tanggal}),s.tanggal&&a.jsx("p",{className:"text-sm text-muted-foreground",children:w(s.tanggal)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(r,{htmlFor:"slot_waktu_mulai_id",children:["Waktu Mulai ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsxs(h,{value:s.slot_waktu_mulai_id,onValueChange:e=>i("slot_waktu_mulai_id",e),children:[a.jsx(g,{children:a.jsx(p,{placeholder:"Pilih waktu mulai"})}),a.jsx(_,{children:l.map(e=>a.jsx(j,{value:e.id.toString(),children:e.label},e.id))})]}),t.slot_waktu_mulai_id&&a.jsx("p",{className:"text-sm text-destructive",children:t.slot_waktu_mulai_id})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(r,{htmlFor:"durasi_slot",children:["Durasi (Slot) ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsxs(h,{value:s.durasi_slot.toString(),onValueChange:e=>i("durasi_slot",parseInt(e)),children:[a.jsx(g,{children:a.jsx(p,{})}),a.jsx(_,{children:[1,2,3,4,5,6,7,8].map(e=>a.jsxs(j,{value:e.toString(),children:[e," slot (",e*45," menit)"]},e))})]}),t.durasi_slot&&a.jsx("p",{className:"text-sm text-destructive",children:t.durasi_slot})]}),m&&a.jsxs(k,{children:[a.jsx(G,{className:"h-4 w-4 animate-spin"}),a.jsx(b,{children:"Mengecek ketersediaan..."})]}),n&&!m&&a.jsxs(k,{variant:n.available?"default":"destructive",children:[n.available?a.jsx(Q,{className:"h-4 w-4"}):a.jsx(U,{className:"h-4 w-4"}),a.jsx(b,{children:n.message})]}),N&&y&&S&&s.tanggal&&a.jsxs(k,{children:[a.jsx(X,{className:"h-4 w-4"}),a.jsx(b,{children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"font-medium",children:N.nama}),a.jsxs("div",{className:"text-sm",children:[w(s.tanggal)," •"," ",y.waktu_mulai," - ",S.waktu_selesai]}),a.jsxs("div",{className:"text-sm",children:["Durasi: ",s.durasi_slot," slot (",s.durasi_slot*45," menit)"]})]})})]})]})]}),a.jsxs(D,{children:[a.jsxs(L,{children:[a.jsx(B,{children:"2. Detail Keperluan"}),a.jsx(T,{children:"Jelaskan keperluan Anda menggunakan laboratorium"})]}),a.jsxs(F,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(r,{htmlFor:"keperluan",children:["Keperluan ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsx(M,{id:"keperluan",value:s.keperluan,onChange:e=>i("keperluan",e.target.value),placeholder:"Contoh: Rapat Tim Penelitian, Workshop, dll",maxLength:200}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.keperluan.length,"/200 karakter"]}),t.keperluan&&a.jsx("p",{className:"text-sm text-destructive",children:t.keperluan})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{htmlFor:"keterangan",children:"Keterangan Tambahan (Opsional)"}),a.jsx(J,{id:"keterangan",value:s.keterangan,onChange:e=>i("keterangan",e.target.value),placeholder:"Tambahkan keterangan tambahan jika diperlukan...",rows:4}),t.keterangan&&a.jsx("p",{className:"text-sm text-destructive",children:t.keterangan})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(A,{href:"/booking-lab",children:a.jsx(x,{type:"button",variant:"outline",disabled:u,children:"Batal"})}),a.jsx(x,{type:"submit",disabled:u||!n?.available||m,children:u?"Menyimpan...":"Ajukan Booking"})]})]})]})]})}export{Na as default};
