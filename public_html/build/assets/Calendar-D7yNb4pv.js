import{u as fe,r as T,j as e,H as je,a as N}from"./app-BsRi02Wf.js";import{B as o,U as q}from"./badge-C_t0DFeo.js";import{B as f}from"./button-4wnz9Zqb.js";import{C as U,a as W,b as G,c as X}from"./card-CtvO2SYM.js";import{C as be,D as ke,a as ve,b as Ne,c as we,d as _e,e as ye}from"./activity-feed-button-BJ1WYF4g.js";import{I as Se}from"./input-BYt-uUAG.js";import{L as R}from"./label-CW3bZicJ.js";import{S as Q,a as Y,b as Z,c as ee,d as ae}from"./select-BiJMe3QD.js";import{C as Ce,T as Te,a as De,b as $e,c as Ie}from"./tabs-X5AeXQYA.js";import{T as Be}from"./textarea-CQXLHOGr.js";import{t as te,A as Ke}from"./app-layout-CdBpmueg.js";import{C as _}from"./clock-CX7qgJh_.js";import{B as se}from"./book-open-DMo6FBlG.js";import{M as re}from"./map-pin-BEWjHYyS.js";import{P as ie}from"./plus-N0VNghkl.js";import{C as A}from"./circle-check-DQIK-M0p.js";import{C as O}from"./circle-x-C3lcXnzp.js";/* empty css            */import"./utils-Cuk0kyiu.js";import"./index-CZi-UQ4q.js";import"./index-C0N98Kzt.js";import"./user-menu-content-CaD6Lgdg.js";import"./index-D-s97nNy.js";import"./index-VkL8W5Kt.js";import"./check-UcFQ4tla.js";import"./building-2-QMJfTkD6.js";import"./calendar-DXPEKcan.js";import"./users-ezrJfIw7.js";function da({semesters:ne,selectedSemesterId:B,kampusList:D,mingguList:K,selectedMinggu:k,hari:v,slots:p,jadwalData:oe,myBookings:z,myMatKuls:de,breadcrumbs:le}){const{flash:S}=fe().props,[me,ce]=T.useState(D[0]?.kode||"B"),[xe,$]=T.useState(!1),[y,E]=T.useState(null),[x,C]=T.useState({kelas_mata_kuliah_id:"",keperluan:"",keterangan:""});T.useEffect(()=>{S?.success&&te({title:"Berhasil",description:S.success,variant:"default",className:"bg-green-50 border-green-200 text-green-900",action:e.jsx(A,{className:"h-5 w-5 text-green-600"})}),S?.error&&te({title:"Gagal",description:S.error,variant:"destructive",className:"bg-red-50 border-red-200 text-red-900",action:e.jsx(O,{className:"h-5 w-5 text-red-600"})})},[S]);const F=t=>{if(!t)return!1;const m=new Date,r=420,w=new Date(m.getTime()+r*60*1e3).toISOString().split("T")[0];return t===w},ue=t=>{N.get("/booking-lab/calendar",{semester_id:t,minggu:1},{preserveState:!0})},V=t=>{const m=Number(t);isNaN(m)||m<1||N.get("/booking-lab/calendar",{semester_id:B,minggu:m},{preserveState:!0,preserveScroll:!0})},I=(t,m,r,s)=>{const w=new Date,j=420,n=new Date(w.getTime()+j*60*1e3);n.setHours(0,0,0,0);const h=new Date(m+"T00:00:00");if(h.setHours(0,0,0,0),h<n){alert("Tidak dapat booking untuk tanggal yang sudah lewat");return}E({kampus_id:t,tanggal:m,slot_mulai_id:r,waktu_mulai:s}),C({kelas_mata_kuliah_id:"",keperluan:"",keterangan:""}),$(!0)},he=()=>{!y||!x.kelas_mata_kuliah_id||!x.keperluan.trim()||N.post("/booking-lab",{kelas_mata_kuliah_id:x.kelas_mata_kuliah_id,laboratorium_id:1,tanggal:y.tanggal,slot_waktu_mulai_id:y.slot_mulai_id,keperluan:x.keperluan,keterangan:x.keterangan},{onSuccess:()=>{$(!1),E(null),C({kelas_mata_kuliah_id:"",keperluan:"",keterangan:""}),setTimeout(()=>{const t=document.getElementById("booking-list");t&&t.scrollIntoView({behavior:"smooth",block:"start"})},500)}})},ge=t=>{const m={menunggu:{variant:"default",label:"Menunggu",icon:_},disetujui:{variant:"success",label:"Disetujui",icon:A},ditolak:{variant:"destructive",label:"Ditolak",icon:O},dibatalkan:{variant:"secondary",label:"Dibatalkan",icon:O},selesai:{variant:"outline",label:"Selesai",icon:A}},r=m[t]||m.menunggu,s=r.icon;return e.jsxs(o,{variant:r.variant,className:"flex items-center gap-1",children:[s&&e.jsx(s,{className:"h-3 w-3"}),r.label]})},H=K.find(t=>t.nomor===Number(k)),J=z.filter(t=>t.status==="menunggu").length;return e.jsxs(Ke,{breadcrumbs:le,children:[e.jsx(je,{title:"Booking Lab - Kalender"}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Booking Laboratorium"}),e.jsxs("p",{className:"text-muted-foreground",children:["Klik slot kosong untuk booking laboratorium",J>0&&e.jsx(f,{variant:"link",size:"sm",className:"ml-2 p-0 h-auto",onClick:()=>{const t=document.getElementById("booking-list");t&&t.scrollIntoView({behavior:"smooth",block:"start"})},children:e.jsxs(o,{variant:"default",children:["(",J,") Request Pending"]})})]})]}),e.jsx("div",{className:"w-72",children:e.jsxs(Q,{value:B?String(B):"",onValueChange:ue,children:[e.jsx(Y,{children:e.jsx(Z,{placeholder:"Pilih Semester"})}),e.jsx(ee,{children:ne.map(t=>e.jsx(ae,{value:String(t.id),children:t.nama},t.id))})]})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>V(Number(k)-1),disabled:Number(k)<=1,children:e.jsx(Ce,{className:"h-4 w-4"})}),e.jsxs("div",{className:"text-center min-w-[200px]",children:[e.jsxs("p",{className:"font-semibold",children:["Minggu ke-",k]}),H&&e.jsx("p",{className:"text-xs text-muted-foreground whitespace-nowrap",children:(()=>{const t=new Date(H.tanggal_mulai),m=new Date(H.tanggal_selesai);return`${t.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})} - ${m.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}`})()})]}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>V(Number(k)+1),disabled:Number(k)>=K.length,children:e.jsx(be,{className:"h-4 w-4"})})]}),e.jsxs(Te,{value:me,onValueChange:ce,children:[e.jsx(De,{className:"grid w-full",style:{gridTemplateColumns:`repeat(${D.length}, 1fr)`},children:D.map(t=>e.jsxs($e,{value:t.kode,children:["Kampus ",t.kode]},t.id))}),D.map(t=>{const m=oe[t.id]||{};return e.jsxs(Ie,{value:t.kode,className:"space-y-4",children:[e.jsxs(U,{children:[e.jsx(W,{children:e.jsxs(G,{children:["Jadwal Kampus ",t.nama]})}),e.jsxs(X,{children:[e.jsx("div",{className:"block md:hidden",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-max",children:e.jsxs("table",{className:"border-collapse text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/50",children:[e.jsx("th",{className:"sticky left-0 z-20 w-24 border-r-2 border-r-gray-300 bg-muted p-1 font-semibold shadow-md min-w-[140px]",children:"Jam"}),v.map(r=>{const s=F(r.tanggal);return e.jsx("th",{className:`border p-2 font-semibold min-w-[160px] md:min-w-0 ${s?"bg-primary/10 ring-2 ring-primary ring-inset":""}`,children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:s?"text-primary font-bold":"",children:r.nama}),r.tanggal&&e.jsxs("span",{className:`text-xs ${s?"text-primary font-semibold":"text-muted-foreground"}`,children:[new Date(r.tanggal).toLocaleDateString("id-ID",{day:"2-digit",month:"short"}),s&&" (Hari Ini)"]})]})},r.id)})]})}),e.jsx("tbody",{children:(()=>{const r={};return v.forEach(s=>{r[s.id]=new Set}),p.map((s,w)=>{const j=s.waktu_mulai==="11:45:00"&&s.waktu_selesai==="13:15:00";return e.jsxs("tr",{className:j?"h-16":"h-24",children:[e.jsxs("td",{className:`sticky left-0 z-10 border p-2 text-center font-mono text-xs font-semibold ${j?"bg-muted h-16":"bg-background h-24"}`,children:[s.waktu_mulai.slice(0,5)," ","-"," ",s.waktu_selesai.slice(0,5)]}),j?e.jsx("td",{colSpan:v.length,className:"border bg-muted/50 p-4 text-center h-16",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-semibold text-muted-foreground",children:"ISTIRAHAT"})]})}):v.map(n=>{if(r[n.id].has(s.id))return null;const h=m[k]?.[n.id]?.[s.id]||[];let b=1;if(h.length>0){b=Math.max(...h.map(a=>{const d=p.findIndex(i=>i.waktu_mulai<=a.waktu_mulai&&i.waktu_selesai>a.waktu_mulai),c=p.findIndex(i=>i.waktu_mulai<a.waktu_selesai&&i.waktu_selesai>=a.waktu_selesai);return d!==-1&&c!==-1?c-d+1:a.durasi_slot||1}));for(let a=0;a<b;a++){const d=w+a;if(d<p.length){const c=p[d].id;r[n.id].add(c)}}}return e.jsx("td",{className:"h-full border p-0 align-middle",rowSpan:b,style:{height:`${b*6}rem`},children:h.length>0?e.jsx("div",{className:"flex h-full flex-col divide-y",children:h.map((a,d)=>{const i=((l,g)=>{const u=[{from:"from-blue-50",to:"to-blue-100",border:"border-blue-500",icon:"text-blue-600",text:"text-blue-900",hover:"hover:from-blue-100 hover:to-blue-200"},{from:"from-green-50",to:"to-green-100",border:"border-green-500",icon:"text-green-600",text:"text-green-900",hover:"hover:from-green-100 hover:to-green-200"},{from:"from-purple-50",to:"to-purple-100",border:"border-purple-500",icon:"text-purple-600",text:"text-purple-900",hover:"hover:from-purple-100 hover:to-purple-200"},{from:"from-orange-50",to:"to-orange-100",border:"border-orange-500",icon:"text-orange-600",text:"text-orange-900",hover:"hover:from-orange-100 hover:to-orange-200"},{from:"from-pink-50",to:"to-pink-100",border:"border-pink-500",icon:"text-pink-600",text:"text-pink-900",hover:"hover:from-pink-100 hover:to-pink-200"},{from:"from-teal-50",to:"to-teal-100",border:"border-teal-500",icon:"text-teal-600",text:"text-teal-900",hover:"hover:from-teal-100 hover:to-teal-200"},{from:"from-indigo-50",to:"to-indigo-100",border:"border-indigo-500",icon:"text-indigo-600",text:"text-indigo-900",hover:"hover:from-indigo-100 hover:to-indigo-200"},{from:"from-amber-50",to:"to-amber-100",border:"border-amber-500",icon:"text-amber-600",text:"text-amber-900",hover:"hover:from-amber-100 hover:to-amber-200"}],L=(l.split("").reduce((M,P)=>M+P.charCodeAt(0),0)+g)%u.length;return u[L]})(a.dosen,d);return e.jsxs("div",{className:`bg-gradient-to-br ${i.from} ${i.to} border-l-4 ${i.border} flex h-full flex-col justify-center p-2 ${i.hover} mx-0.5 my-0.5 rounded-lg shadow-sm transition-all duration-200 hover:shadow-md relative ${a.status==="tidak_masuk"&&!a.is_my_schedule?"cursor-pointer ring-2 ring-orange-400 ring-opacity-50":""}`,onClick:()=>{a.status==="tidak_masuk"&&!a.is_my_schedule&&n.tanggal&&I(t.id,n.tanggal,s.id,s.waktu_mulai)},children:[a.status==="tidak_masuk"&&!a.is_my_schedule&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-orange-500 text-white text-xs px-2 py-0.5 rounded-bl-lg rounded-tr-lg font-semibold shadow-md z-10",children:"ðŸ“… Bisa Dibook"}),e.jsxs("div",{className:"mb-2 flex items-start gap-1.5",children:[e.jsx(se,{className:`h-4 w-4 ${i.icon} mt-0.5 flex-shrink-0`}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:`font-bold ${i.text} truncate text-xs leading-tight`,children:a.matkul}),e.jsx("div",{className:"mt-0.5 flex items-center gap-1",children:e.jsx(o,{variant:"muted",className:"truncate px-1.5 py-0.5 text-xs font-medium",children:a.kelas})})]})]}),e.jsxs("div",{className:"space-y-0.5 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx(q,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"flex-1 truncate font-medium",children:a.dosen})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx(re,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"flex-1 truncate font-medium",children:a.lab})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx(_,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{className:"flex-1 font-medium",children:[a.waktu_mulai.slice(0,5)," ","-"," ",a.waktu_selesai.slice(0,5)]})]})]}),e.jsxs("div",{className:`mt-1.5 flex items-center justify-between border-t pt-1.5 ${i.border.replace("border-","border-opacity-20 border-")}`,children:[e.jsx("div",{className:"flex gap-0.5",children:e.jsxs(o,{variant:"outline",className:"px-1.5 py-0.5 text-xs font-medium",children:[a.sks," ","SKS"]})}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.is_active&&!a.is_past&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium bg-yellow-500 text-white",children:"Berlangsung"}),a.is_past&&e.jsx(o,{variant:"secondary",className:"px-1.5 py-0.5 text-xs font-medium",children:"Sudah Lewat"}),a.status==="pending"&&!a.is_past&&!a.is_active&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium",children:"Pending"}),a.status==="booking"&&!a.is_past&&!a.is_active&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium bg-orange-500",children:"Booking"}),a.is_my_schedule&&!a.is_past&&!a.is_active&&a.status!=="booking"&&a.status==="terjadwal"&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium bg-green-600",children:"Jadwal Saya"}),a.status==="terjadwal"&&!a.is_past&&!a.is_active&&!a.is_my_schedule&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium bg-blue-500",children:"Terjadwal"}),a.status==="selesai"&&e.jsx(o,{variant:"secondary",className:"px-1.5 py-0.5 text-xs font-medium",children:"Selesai"}),a.status==="tidak_masuk"&&e.jsx(o,{variant:"outline",className:"px-1.5 py-0.5 text-xs font-medium",children:"Tidak Masuk"}),a.status==="dibatalkan"&&e.jsx(o,{variant:"destructive",className:"px-1.5 py-0.5 text-xs font-medium",children:"Dibatalkan"})]})]}),a.is_my_schedule&&!a.is_past&&a.status==="terjadwal"&&e.jsx("div",{className:"mt-2",children:e.jsx(f,{variant:"outline",size:"sm",className:"w-full text-xs h-7",onClick:()=>{confirm('Tandai jadwal ini sebagai "Tidak Masuk"?')&&N.post(`/sesi-jadwal/${a.sesi_jadwal_id}/update-status`,{status:"tidak_masuk",catatan:null})},children:"Tidak Masuk"})}),a.is_my_schedule&&!a.is_past&&a.status==="tidak_masuk"&&e.jsx("div",{className:"mt-2",children:e.jsx(f,{variant:"default",size:"sm",className:"w-full text-xs h-7",onClick:()=>{confirm('Kembalikan status ke "Terjadwal"?')&&N.post(`/sesi-jadwal/${a.sesi_jadwal_id}/reset-status`)},children:"Reset Status"})})]},d)})}):(()=>{const a=new Date,d=420,c=a.getTimezoneOffset(),i=new Date(a.getTime()+(d+c)*60*1e3);i.setHours(0,0,0,0);const l=n.tanggal?new Date(n.tanggal+"T00:00:00"):null;l&&l.setHours(0,0,0,0);const g=l&&l<i,u=l&&l.getTime()===i.getTime();return e.jsx("div",{className:`h-24 flex items-center justify-center transition-colors ${g?"bg-muted/30 cursor-not-allowed":"cursor-pointer hover:bg-green-50/50 hover:border-green-400 border-2 border-dashed border-transparent group"}`,onClick:()=>{!g&&n.tanggal&&I(t.id,n.tanggal,s.id,s.waktu_mulai)},children:g?e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(_,{className:"h-5 w-5 mx-auto mb-1 opacity-50"}),e.jsx("div",{className:"text-xs font-medium",children:"Sudah Lewat"})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(ie,{className:`h-6 w-6 mx-auto mb-1 ${u?"text-primary":"text-green-600 group-hover:text-green-700"}`}),e.jsx("div",{className:`text-sm font-medium ${u?"text-primary":"text-green-700 group-hover:text-green-800"}`,children:u?"Booking Hari Ini":"Booking"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-0.5 group-hover:text-green-600",children:"Klik untuk ajukan"})]})})})()},n.id)})]},s.id)})})()})]})})})})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-fixed border-collapse text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/50",children:[e.jsx("th",{className:"sticky left-0 z-20 w-24 md:w-32 border bg-muted p-2 font-semibold",children:"Jam"}),v.map(r=>{const s=F(r.tanggal);return e.jsx("th",{className:`border p-2 font-semibold min-w-[160px] md:min-w-0 ${s?"bg-primary/10 ring-2 ring-primary ring-inset":""}`,children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:s?"text-primary font-bold":"",children:r.nama}),r.tanggal&&e.jsxs("span",{className:`text-xs ${s?"text-primary font-semibold":"text-muted-foreground"}`,children:[new Date(r.tanggal).toLocaleDateString("id-ID",{day:"2-digit",month:"short"}),s&&" (Hari Ini)"]})]})},r.id)})]})}),e.jsx("tbody",{children:(()=>{const r={};return v.forEach(s=>{r[s.id]=new Set}),p.map((s,w)=>{const j=s.waktu_mulai==="11:45:00"&&s.waktu_selesai==="13:15:00";return e.jsxs("tr",{className:j?"h-16":"h-24",children:[e.jsxs("td",{className:`sticky left-0 z-10 border p-2 text-center font-mono text-xs font-semibold ${j?"bg-muted h-16":"bg-background h-24"}`,children:[s.waktu_mulai.slice(0,5)," ","-"," ",s.waktu_selesai.slice(0,5)]}),j?e.jsx("td",{colSpan:v.length,className:"border bg-muted/50 p-4 text-center h-16",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-semibold text-muted-foreground",children:"ISTIRAHAT"})]})}):v.map(n=>{if(r[n.id].has(s.id))return null;const h=m[k]?.[n.id]?.[s.id]||[];let b=1;if(h.length>0){b=Math.max(...h.map(a=>{const d=p.findIndex(i=>i.waktu_mulai<=a.waktu_mulai&&i.waktu_selesai>a.waktu_mulai),c=p.findIndex(i=>i.waktu_mulai<a.waktu_selesai&&i.waktu_selesai>=a.waktu_selesai);return d!==-1&&c!==-1?c-d+1:a.durasi_slot||1}));for(let a=0;a<b;a++){const d=w+a;if(d<p.length){const c=p[d].id;r[n.id].add(c)}}}return e.jsx("td",{className:"h-full border p-0 align-middle",rowSpan:b,style:{height:`${b*6}rem`},children:h.length>0?e.jsx("div",{className:"flex h-full flex-col divide-y",children:h.map((a,d)=>{const i=((l,g)=>{const u=[{from:"from-blue-50",to:"to-blue-100",border:"border-blue-500",icon:"text-blue-600",text:"text-blue-900",hover:"hover:from-blue-100 hover:to-blue-200"},{from:"from-green-50",to:"to-green-100",border:"border-green-500",icon:"text-green-600",text:"text-green-900",hover:"hover:from-green-100 hover:to-green-200"},{from:"from-purple-50",to:"to-purple-100",border:"border-purple-500",icon:"text-purple-600",text:"text-purple-900",hover:"hover:from-purple-100 hover:to-purple-200"},{from:"from-orange-50",to:"to-orange-100",border:"border-orange-500",icon:"text-orange-600",text:"text-orange-900",hover:"hover:from-orange-100 hover:to-orange-200"},{from:"from-pink-50",to:"to-pink-100",border:"border-pink-500",icon:"text-pink-600",text:"text-pink-900",hover:"hover:from-pink-100 hover:to-pink-200"},{from:"from-teal-50",to:"to-teal-100",border:"border-teal-500",icon:"text-teal-600",text:"text-teal-900",hover:"hover:from-teal-100 hover:to-teal-200"},{from:"from-indigo-50",to:"to-indigo-100",border:"border-indigo-500",icon:"text-indigo-600",text:"text-indigo-900",hover:"hover:from-indigo-100 hover:to-indigo-200"},{from:"from-amber-50",to:"to-amber-100",border:"border-amber-500",icon:"text-amber-600",text:"text-amber-900",hover:"hover:from-amber-100 hover:to-amber-200"}],L=(l.split("").reduce((M,P)=>M+P.charCodeAt(0),0)+g)%u.length;return u[L]})(a.dosen,d);return e.jsxs("div",{className:`bg-gradient-to-br ${i.from} ${i.to} border-l-4 ${i.border} flex h-full flex-col justify-center p-2 ${i.hover} mx-0.5 my-0.5 rounded-lg shadow-sm transition-all duration-200 hover:shadow-md relative ${a.status==="tidak_masuk"&&!a.is_my_schedule?"cursor-pointer ring-2 ring-orange-400 ring-opacity-50":""}`,onClick:()=>{a.status==="tidak_masuk"&&!a.is_my_schedule&&n.tanggal&&I(t.id,n.tanggal,s.id,s.waktu_mulai)},children:[a.status==="tidak_masuk"&&!a.is_my_schedule&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-orange-500 text-white text-xs px-2 py-0.5 rounded-bl-lg rounded-tr-lg font-semibold shadow-md z-10",children:"ðŸ“… Bisa Dibook"}),e.jsxs("div",{className:"mb-2 flex items-start gap-1.5",children:[e.jsx(se,{className:`h-4 w-4 ${i.icon} mt-0.5 flex-shrink-0`}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:`font-bold ${i.text} truncate text-xs leading-tight`,children:a.matkul}),e.jsx("div",{className:"mt-0.5 flex items-center gap-1",children:e.jsx(o,{variant:"muted",className:"truncate px-1.5 py-0.5 text-xs font-medium",children:a.kelas})})]})]}),e.jsxs("div",{className:"space-y-0.5 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx(q,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"flex-1 truncate font-medium",children:a.dosen})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx(re,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"flex-1 truncate font-medium",children:a.lab})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[e.jsx(_,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{className:"flex-1 font-medium",children:[a.waktu_mulai.slice(0,5)," ","-"," ",a.waktu_selesai.slice(0,5)]})]})]}),e.jsxs("div",{className:`mt-1.5 flex items-center justify-between border-t pt-1.5 ${i.border.replace("border-","border-opacity-20 border-")}`,children:[e.jsx("div",{className:"flex gap-0.5",children:e.jsxs(o,{variant:"outline",className:"px-1.5 py-0.5 text-xs font-medium",children:[a.sks," ","SKS"]})}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.is_active&&!a.is_past&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium bg-yellow-500 text-white",children:"Berlangsung"}),a.is_past&&e.jsx(o,{variant:"secondary",className:"px-1.5 py-0.5 text-xs font-medium",children:"Sudah Lewat"}),a.status==="pending"&&!a.is_past&&!a.is_active&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium",children:"Pending"}),a.status==="booking"&&!a.is_past&&!a.is_active&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium bg-orange-500",children:"Booking"}),a.is_my_schedule&&!a.is_past&&!a.is_active&&a.status!=="booking"&&a.status==="terjadwal"&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium bg-green-600",children:"Jadwal Saya"}),a.status==="terjadwal"&&!a.is_past&&!a.is_active&&!a.is_my_schedule&&e.jsx(o,{variant:"default",className:"px-1.5 py-0.5 text-xs font-medium bg-blue-500",children:"Terjadwal"}),a.status==="selesai"&&e.jsx(o,{variant:"secondary",className:"px-1.5 py-0.5 text-xs font-medium",children:"Selesai"}),a.status==="tidak_masuk"&&e.jsx(o,{variant:"outline",className:"px-1.5 py-0.5 text-xs font-medium",children:"Tidak Masuk"}),a.status==="dibatalkan"&&e.jsx(o,{variant:"destructive",className:"px-1.5 py-0.5 text-xs font-medium",children:"Dibatalkan"})]})]}),a.is_my_schedule&&!a.is_past&&a.status==="terjadwal"&&e.jsx("div",{className:"mt-2",children:e.jsx(f,{variant:"outline",size:"sm",className:"w-full text-xs h-7",onClick:()=>{confirm('Tandai jadwal ini sebagai "Tidak Masuk"?')&&N.post(`/sesi-jadwal/${a.sesi_jadwal_id}/update-status`,{status:"tidak_masuk",catatan:null})},children:"Tidak Masuk"})}),a.is_my_schedule&&!a.is_past&&a.status==="tidak_masuk"&&e.jsx("div",{className:"mt-2",children:e.jsx(f,{variant:"default",size:"sm",className:"w-full text-xs h-7",onClick:()=>{confirm('Kembalikan status ke "Terjadwal"?')&&N.post(`/sesi-jadwal/${a.sesi_jadwal_id}/reset-status`)},children:"Reset Status"})})]},d)})}):(()=>{const a=new Date,d=420,c=a.getTimezoneOffset(),i=new Date(a.getTime()+(d+c)*60*1e3);i.setHours(0,0,0,0);const l=n.tanggal?new Date(n.tanggal+"T00:00:00"):null;l&&l.setHours(0,0,0,0);const g=l&&l<i,u=l&&l.getTime()===i.getTime();return e.jsx("div",{className:`h-24 flex items-center justify-center transition-colors ${g?"bg-muted/30 cursor-not-allowed":"cursor-pointer hover:bg-green-50/50 hover:border-green-400 border-2 border-dashed border-transparent group"}`,onClick:()=>{!g&&n.tanggal&&I(t.id,n.tanggal,s.id,s.waktu_mulai)},children:g?e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(_,{className:"h-5 w-5 mx-auto mb-1 opacity-50"}),e.jsx("div",{className:"text-xs font-medium",children:"Sudah Lewat"})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(ie,{className:`h-6 w-6 mx-auto mb-1 ${u?"text-primary":"text-green-600 group-hover:text-green-700"}`}),e.jsx("div",{className:`text-sm font-medium ${u?"text-primary":"text-green-700 group-hover:text-green-800"}`,children:u?"Booking Hari Ini":"Booking"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-0.5 group-hover:text-green-600",children:"Klik untuk ajukan"})]})})})()},n.id)})]},s.id)})})()})]})})})]})]}),z.length>0&&e.jsxs(U,{id:"booking-list",children:[e.jsx(W,{children:e.jsx(G,{children:"Request Booking Saya"})}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:z.map(r=>e.jsx("div",{className:"rounded-lg border p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[ge(r.status),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(r.tanggal).toLocaleDateString("id-ID")})]}),e.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[r.mata_kuliah&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Mata Kuliah: "}),r.mata_kuliah.nama," (",r.mata_kuliah.sks," SKS)"]}),r.kelas&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Kelas: "}),r.kelas]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Lab: "}),r.laboratorium.nama]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Waktu: "}),r.waktu_mulai," - ",r.waktu_selesai]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Keperluan: "}),r.keperluan]})]})]}),r.status==="menunggu"&&e.jsx(f,{size:"sm",variant:"outline",onClick:()=>{confirm("Batalkan booking ini?")&&N.post(`/booking-lab/${r.id}/cancel`)},children:"Batalkan"})]})},r.id))})})]})]},t.id)})]}),K.length===0&&e.jsx("div",{className:"flex h-64 items-center justify-center rounded-md border",children:e.jsx("p",{className:"text-muted-foreground",children:"Belum ada jadwal. Silakan pilih semester."})})]}),e.jsx(ke,{open:xe,onOpenChange:$,children:e.jsxs(ve,{children:[e.jsxs(Ne,{children:[e.jsx(we,{children:"Booking Laboratorium"}),e.jsx(_e,{children:"Isi form berikut untuk mengajukan booking laboratorium"})]}),y&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3 space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Tanggal: "}),new Date(y.tanggal).toLocaleDateString("id-ID")]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Waktu Mulai: "}),y.waktu_mulai.slice(0,5)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{htmlFor:"mata_kuliah",children:["Mata Kuliah ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Q,{value:x.kelas_mata_kuliah_id,onValueChange:t=>C({...x,kelas_mata_kuliah_id:t}),children:[e.jsx(Y,{children:e.jsx(Z,{placeholder:"Pilih Mata Kuliah"})}),e.jsx(ee,{children:de.map(t=>e.jsxs(ae,{value:String(t.id),children:[t.nama," - ",t.kelas," (",t.sks," SKS)"]},t.id))})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Durasi booking akan disesuaikan dengan SKS mata kuliah"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{htmlFor:"keperluan",children:["Keperluan ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(Se,{id:"keperluan",placeholder:"Misal: Praktikum, Remedial, dll",value:x.keperluan,onChange:t=>C({...x,keperluan:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"keterangan",children:"Keterangan (Opsional)"}),e.jsx(Be,{id:"keterangan",placeholder:"Tambahkan keterangan jika diperlukan...",rows:3,value:x.keterangan,onChange:t=>C({...x,keterangan:t.target.value})})]})]}),e.jsxs(ye,{children:[e.jsx(f,{variant:"outline",onClick:()=>$(!1),children:"Batal"}),e.jsx(f,{onClick:he,disabled:!x.kelas_mata_kuliah_id||!x.keperluan.trim(),children:"Ajukan Booking"})]})]})})]})}export{da as default};
